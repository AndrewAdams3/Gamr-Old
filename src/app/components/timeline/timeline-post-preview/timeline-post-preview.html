<div class="modal fade" bsModal #staticModal="bs-modal" [config]="{ignoreBackdropClick: false}" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <timeline-post-modal [post]="post" (destroyPost)="destroyPostHandler($event)"></timeline-post-modal>
</div>

<div class="panel post-panel" (click)="$event.target.className.indexOf('no-open') == -1 ? staticModal.show() : '';">
    <div class="panel-body post-panel">
        <div class="media">
            <!--Image-->
            <div class="media-left media-top">
                <a [routerLink]="[ '/u', post.user.tag] ">
                    <img class="media-object img-rounded author-image" [attr.src]="post.user.profile_pic" alt="...">
                </a>
            </div>

            <div class="media-body">
                <!--Dropdown options-->
                <div class="dropdown no-open" dropdown>
                    <a dropdownToggle class="dropdown-toggle">
                        <span class="glyphicon glyphicon-collapse-down dropdown-icon no-open" aria-hidden="true"></span>
                    </a>
                    <ul *dropdownMenu class="dropdown-menu pull-right" role="menu">
                        <li role="menuitem no-open"><a class="dropdown-item no-open">Copy Link</a></li>
                        <li role="menuitem no-open"><a class="dropdown-item no-open" *ngIf="user.ID == post.user.ID" (click)="deletePost(); ">Delete</a></li>
                        <li role="menuitem no-open"><a class="dropdown-item no-open">Share</a></li>
                        <li class="divider dropdown-divider"></li>
                        <li role="menuitem no-open"><a class="dropdown-item no-open">Report Post</a>
                        </li>
                    </ul>
                </div>

                <!--Author and timestamp-->
                <p>
                    <a class="author-name" [routerLink]="[ '/u', post.user.tag] "> {{post.user.display_name}} </a>
                    <small>{{ post.creation_date | amTimeAgo }} </small>
                </p>

                <!--Text -->
                <p class="text-container">
                    <span *ngFor="let chunk of post.text" class="text-element " [ngSwitch]="chunk.indexOf(post.uuid)==0 ">
                        <a *ngSwitchCase="true " class="mention" [routerLink]="[ '/u', chunk.replace(regex, '') ] ">@{{chunk.replace(regex, '')}}</a>
                        <span *ngSwitchCase="false ">{{chunk}}</span>
                    </span>
                </p>
            </div>
            <!--Images-->
            <div class="image-grid ">
                <div *ngFor="let image of post.attachments.images; let i=index ">
                    <img *ngIf="i==0 " class="grid-image img-responsive no-open " [src]="image.src" (click)="openImage(i, $event) " />
                </div>
                <span class="badge image-count-badge " *ngIf="post.attachments.images.length> 1">1 of {{post.attachments.images.length}}</span>
            </div>
        </div>


        <!--Options/Stats-->
        <div class="actions" [ngSwitch]="post.user_ID == user.ID">
            <!-- Switch Cases -->
            <button *ngSwitchCase="true" class="static-stat no-open" [ngStyle]="{'background-color':post.liked ? '#985E6D' : '' }">
                <i class="fa fa-heart no-open"></i><span class="action-text no-open">{{post.likes.length}}</span> 
            </button>
            <button *ngSwitchCase="false" class="action-button no-open" (click)="likePost()" [ngStyle]="{'background-color':post.liked ? '#985E6D' : '' }">
                <i class="fa fa-heart no-open" ></i><span class="action-text no-open">{{post.likes.length}}</span> 
            </button>
            <!-- End Switch Cases  -->
            <button class="action-button no-open static-stat">
                <i class="fa fa-comment"></i> <span class="action-text no-open">{{post.response_count || 0}}</span><!-- Comments -->
            </button>
            <button class="action-button no-open static-stat">
                <i class="fa fa-mail-reply"></i> <span class="action-text no-open">0</span><!-- Shares -->
            </button>
            <button class="action-button no-open" style="float:right;">
                <i class="glyphicon glyphicon-signal no-open"></i> <span class="action-text no-open">{{post.exp_count || 0}}</span>
            </button>
        </div>

    </div>
</div>